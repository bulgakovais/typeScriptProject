import { renderUserBlock } from "../user.js";
import { getFavoritePlacesFromLocalStorage } from "./getFavoritePlacesFromLocalStorage.js";
import { getFavoritesCaption, getUserData } from "./userData.js";
export function favoritesHandlerClick(event, places) {
    const element = event.target;
    if (element.classList.contains("btn-book-place'")) {
        console.log(event.target);
    }
    // Если нажали на значок избранного
    if (element.classList.contains("favorites")) {
        let targetHeart = event.target;
        if (targetHeart.tagName != 'DIV')
            return;
        let targetPlace = null;
        places.forEach(place => {
            if (place.id == targetHeart.id) {
                return targetPlace = place;
            }
        });
        toggleFavoriteItem(targetHeart, targetPlace);
    }
}
function toggleFavoriteItem(listItem, targetPlace) {
    let favoritePlaces = getFavoritePlacesFromLocalStorage();
    if (listItem.classList.contains('active')) {
        listItem.classList.remove('active');
        if (Array.isArray(favoritePlaces)) {
            const updatedFavorites = favoritePlaces.filter((f) => f.id != listItem.id);
            localStorage.setItem('favoriteItems', JSON.stringify(updatedFavorites));
        }
    }
    else {
        listItem.classList.add('active');
        const data = { id: targetPlace.id, name: targetPlace.name, image: targetPlace.image };
        if (Array.isArray(favoritePlaces)) {
            const allData = JSON.stringify([...favoritePlaces, data]);
            localStorage.setItem('favoriteItems', allData);
        }
    }
    // Запускаем рендер <header> сайта
    const user = getUserData();
    const favoritesCaption = getFavoritesCaption();
    renderUserBlock(user, favoritesCaption);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmF2b3JpdGVzSGFuZGxlckNsaWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2hlbHBlcnMvZmF2b3JpdGVzSGFuZGxlckNsaWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxZQUFZLENBQUE7QUFDNUMsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0sd0NBQXdDLENBQUE7QUFDMUYsT0FBTyxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLGVBQWUsQ0FBQTtBQUdoRSxNQUFNLFVBQVUscUJBQXFCLENBQUMsS0FBWSxFQUFFLE1BQWU7SUFDakUsTUFBTSxPQUFPLEdBQWdCLEtBQUssQ0FBQyxNQUFxQixDQUFBO0lBQ3hELElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsaUJBQWlCLENBQUMsRUFBRTtRQUNqRCxPQUFPLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQTtLQUMxQjtJQUNELG1DQUFtQztJQUNuQyxJQUFJLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxFQUFFO1FBQzNDLElBQUksV0FBVyxHQUFnQixLQUFLLENBQUMsTUFBcUIsQ0FBQTtRQUMxRCxJQUFJLFdBQVcsQ0FBQyxPQUFPLElBQUksS0FBSztZQUFFLE9BQU07UUFDeEMsSUFBSSxXQUFXLEdBQVUsSUFBSSxDQUFBO1FBQzdCLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDckIsSUFBSSxLQUFLLENBQUMsRUFBRSxJQUFJLFdBQVcsQ0FBQyxFQUFFLEVBQUU7Z0JBQzlCLE9BQU8sV0FBVyxHQUFHLEtBQUssQ0FBQTthQUMzQjtRQUNILENBQUMsQ0FBQyxDQUFBO1FBQ0Ysa0JBQWtCLENBQUMsV0FBVyxFQUFFLFdBQVcsQ0FBQyxDQUFBO0tBQzdDO0FBQ0gsQ0FBQztBQUVELFNBQVMsa0JBQWtCLENBQUMsUUFBcUIsRUFBRSxXQUFrQjtJQUNuRSxJQUFJLGNBQWMsR0FBYyxpQ0FBaUMsRUFBRSxDQUFBO0lBQ25FLElBQUksUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUU7UUFDekMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUE7UUFDbkMsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBRWpDLE1BQU0sZ0JBQWdCLEdBQXVELGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1lBQzlILFlBQVksQ0FBQyxPQUFPLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFBO1NBQ3hFO0tBQ0Y7U0FDSTtRQUNILFFBQVEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFBO1FBQ2hDLE1BQU0sSUFBSSxHQUFHLEVBQUUsRUFBRSxFQUFFLFdBQVcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFdBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQTtRQUNyRixJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBQUU7WUFDakMsTUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsY0FBYyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUE7WUFDekQsWUFBWSxDQUFDLE9BQU8sQ0FBQyxlQUFlLEVBQUUsT0FBTyxDQUFDLENBQUE7U0FDL0M7S0FDRjtJQUVELGtDQUFrQztJQUNsQyxNQUFNLElBQUksR0FBRyxXQUFXLEVBQUUsQ0FBQTtJQUMxQixNQUFNLGdCQUFnQixHQUFHLG1CQUFtQixFQUFFLENBQUE7SUFDOUMsZUFBZSxDQUFDLElBQUksRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO0FBQ3pDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQbGFjZSB9IGZyb20gXCIuLi9zdG9yZS9kb21haW4vcGxhY2UuanNcIlxuaW1wb3J0IHsgcmVuZGVyVXNlckJsb2NrIH0gZnJvbSBcIi4uL3VzZXIuanNcIlxuaW1wb3J0IHsgZ2V0RmF2b3JpdGVQbGFjZXNGcm9tTG9jYWxTdG9yYWdlIH0gZnJvbSBcIi4vZ2V0RmF2b3JpdGVQbGFjZXNGcm9tTG9jYWxTdG9yYWdlLmpzXCJcbmltcG9ydCB7IGdldEZhdm9yaXRlc0NhcHRpb24sIGdldFVzZXJEYXRhIH0gZnJvbSBcIi4vdXNlckRhdGEuanNcIlxuXG5cbmV4cG9ydCBmdW5jdGlvbiBmYXZvcml0ZXNIYW5kbGVyQ2xpY2soZXZlbnQ6IEV2ZW50LCBwbGFjZXM6IFBsYWNlW10pIHtcbiAgY29uc3QgZWxlbWVudDogSFRNTEVsZW1lbnQgPSBldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnRcbiAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYnRuLWJvb2stcGxhY2UnXCIpKSB7XG4gICAgY29uc29sZS5sb2coZXZlbnQudGFyZ2V0KVxuICB9XG4gIC8vINCV0YHQu9C4INC90LDQttCw0LvQuCDQvdCwINC30L3QsNGH0L7QuiDQuNC30LHRgNCw0L3QvdC+0LPQvlxuICBpZiAoZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJmYXZvcml0ZXNcIikpIHtcbiAgICBsZXQgdGFyZ2V0SGVhcnQ6IEhUTUxFbGVtZW50ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gICAgaWYgKHRhcmdldEhlYXJ0LnRhZ05hbWUgIT0gJ0RJVicpIHJldHVyblxuICAgIGxldCB0YXJnZXRQbGFjZTogUGxhY2UgPSBudWxsXG4gICAgcGxhY2VzLmZvckVhY2gocGxhY2UgPT4ge1xuICAgICAgaWYgKHBsYWNlLmlkID09IHRhcmdldEhlYXJ0LmlkKSB7XG4gICAgICAgIHJldHVybiB0YXJnZXRQbGFjZSA9IHBsYWNlXG4gICAgICB9XG4gICAgfSlcbiAgICB0b2dnbGVGYXZvcml0ZUl0ZW0odGFyZ2V0SGVhcnQsIHRhcmdldFBsYWNlKVxuICB9XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZUZhdm9yaXRlSXRlbShsaXN0SXRlbTogSFRNTEVsZW1lbnQsIHRhcmdldFBsYWNlOiBQbGFjZSkge1xuICBsZXQgZmF2b3JpdGVQbGFjZXM6IHVua25vd25bXSA9IGdldEZhdm9yaXRlUGxhY2VzRnJvbUxvY2FsU3RvcmFnZSgpXG4gIGlmIChsaXN0SXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XG4gICAgbGlzdEl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICBpZiAoQXJyYXkuaXNBcnJheShmYXZvcml0ZVBsYWNlcykpIHtcblxuICAgICAgY29uc3QgdXBkYXRlZEZhdm9yaXRlczogQXJyYXk8eyBpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIGltYWdlOiBzdHJpbmcgfT4gPSBmYXZvcml0ZVBsYWNlcy5maWx0ZXIoKGYpID0+IGYuaWQgIT0gbGlzdEl0ZW0uaWQpXG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnZmF2b3JpdGVJdGVtcycsIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRGYXZvcml0ZXMpKVxuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICBsaXN0SXRlbS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgIGNvbnN0IGRhdGEgPSB7IGlkOiB0YXJnZXRQbGFjZS5pZCwgbmFtZTogdGFyZ2V0UGxhY2UubmFtZSwgaW1hZ2U6IHRhcmdldFBsYWNlLmltYWdlIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShmYXZvcml0ZVBsYWNlcykpIHtcbiAgICAgIGNvbnN0IGFsbERhdGEgPSBKU09OLnN0cmluZ2lmeShbLi4uZmF2b3JpdGVQbGFjZXMsIGRhdGFdKVxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Zhdm9yaXRlSXRlbXMnLCBhbGxEYXRhKVxuICAgIH1cbiAgfVxuXG4gIC8vINCX0LDQv9GD0YHQutCw0LXQvCDRgNC10L3QtNC10YAgPGhlYWRlcj4g0YHQsNC50YLQsFxuICBjb25zdCB1c2VyID0gZ2V0VXNlckRhdGEoKVxuICBjb25zdCBmYXZvcml0ZXNDYXB0aW9uID0gZ2V0RmF2b3JpdGVzQ2FwdGlvbigpXG4gIHJlbmRlclVzZXJCbG9jayh1c2VyLCBmYXZvcml0ZXNDYXB0aW9uKVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgZmF2b3JpdGVQbGFjZUludGVyZmFjZSBleHRlbmRzIFBsYWNlIHtcbiAgaWQ6IHN0cmluZyxcbiAgbmFtZTogc3RyaW5nLFxuICBpbWFnZTogc3RyaW5nXG59XG4iXX0=